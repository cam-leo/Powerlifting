<script>
$(document).ready(function() {
  if ($('#TOC').length === 0) {
    console.log("Table of Contents not found. Attempting to create one.");
    var toc = $('<div id="TOC"></div>');
    $('body').prepend(toc);
    
    $('h1, h2, h3').each(function() {
      var $this = $(this);
      var id = $this.attr('id') || $this.text().toLowerCase().replace(/[^a-z0-9]/g, '-');
      $this.attr('id', id);
      
      var level = parseInt(this.tagName.substring(1)) - 1;
      var indent = '  '.repeat(level);
      toc.append(indent + '<a href="#' + id + '">' + $this.text() + '</a><br>');
    });
  }
});
</script>